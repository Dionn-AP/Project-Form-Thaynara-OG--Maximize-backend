
## üíª Sobre o projeto

üéì Desafio (Thaynara OG - Challenge), proposto pela empresa Maximize para concorr√™ncia √† vaga de est√°gio (Frontend). Trata-se de um formul√°rio para que qualquer pessoa possa enviar uma mesagem com proposta de contato √† pessoa fict√≠cia em quest√£o (Thaynara OG). Ap√≥s enviar sua mensagem o destint√°rio recebe um email de confirma√ß√£o e sauda√ß√£o. Tamb√©m conta com um servi√ßo de CMS/Manager, onde a "Thanara OG" poder√° acessar o sistema e visualizar na sua caixa de entrada dentro da pr√≥pria aplica√ß√£o, as mensagem recebidas, bem como respond√™-las. Abaixo segue algumas funcionalidades da aplica√ß√£o: 

- Login de usu√°rio (nessa etapa h√° apenas um usu√°rio em quest√£o, ent√£o trata-se de um login administrativo)
- Usu√°rio externo poder√° enviar mensagens ao propriet√°rio do site (pessoa fict√≠cia em quest√£o)
- Visualizar mensagens recebidas
- Responder ao email recebido

---

## Endpoints

### URL principal
```
https://contact-forms-qgj8.onrender.com/
```
### Abaixo est√£o listadas as URLs que ser√£o utilizadas para acessar a API.

#### Obs1: O formato de comunica√ß√£o dos dados √© JSON. Toda request com payload em JSON dever√° conter o header **Content-Type: application/json**

#### Obs2: O **token** de acesso obtido √© o token que voc√™ precisa passar no header de algumas das requests subsequentes.
```
Authorization: Bearer {accessToken}
```
---
### /user (post)

Essa rota posibilita criar um novo usu√°rio atrav√©s do fornecimento de nome, email e senha. N√£o precisa de autentica√ß√£o.

#### Body Parameters


| Parameters | Type | Description |
| -------- | -------- | -------- |
| name     | string     | name do usu√°rio     |
| email    | string   | email do usu√°rio|
| password | string | senha do usu√°rio |

#### Request

```
{
    "name": "Fulano de Tal",
    "email": "fulanodetal@email.com",
    "password": "12345678"
}
```

#### Response (201)
```
{
    message: "Usu√°rio cadastrado com sucesso"
}


Obs: S√£o retornado os dados cadastros
```
### Poss√≠veis erros de cadastro de usu√°rio
#### Error (400) - O email escolhido para cadastro j√° existe

```
{
    "message": "Este email ja foi cadastrado. Favor escolha outro email"
}
```

#### Error (400) - Erro ao se cadastrar

```
{
    "message": "N√£o foi possivel cadastrar o usu√°rio"
}
```


---
### /login (post)

Essa rota permite logar no sistema, informando email e senha cadastrados anteriormente. N√£o precisa de autentica√ß√£o.

#### Body Parameters


| Parameters | Type | Description |
| -------- | -------- | -------- |
| id     | number   |  id √∫nico do usu√°rio |
|  name  |  string  |   nome do usu√°rio  |
| email    | string   | email do usu√°rio|
| password | string | senha do usu√°rio |
| token   | string  | token de autentica√ß√£o |

#### Request

```
{
    "email": "fulanodetal@email.com",
    "password": "12345678"
}
```

#### Response (200)
```
{
    
    "id": 1,
    "name": "Fulano de Tal",
    "email": "fulanodetal@email.com"
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiaWF0IjoxNjc1ODgyODgzLCJleHAiOjE2NzU5MDA4ODN9.hZMnv0GdrYtuRVCQgEdySdDps2Vqx_TfNOIyiv04qbw"
}

```
### Poss√≠veis erros de login de usu√°rio
#### Error (422) - Email n√£o informado na requisi√ß√£o

```
{
    "message": "Voc√™ precisa informar um email"
}
```

#### Error (422) - Senha n√£o informado na requisi√ß√£o

```
{
    "message": "Voc√™ precisa informar uma senha"
}
```

#### Error (422) - Email e senha n√£o informados na requisi√ß√£o

```
{
    "message": "Voc√™ precisa informar um email e senha"
}
```

#### Error (404) - N√£o foi poss√≠vel localizar os dados do usu√°rio

```
{
    "message": "Usu√°rio n√£o encontrado"
}
```

#### Error (404) - Email ou senha inv√°lidos

```
{
    "message": "Email ou senha inv√°lidos"
}
```


---
### /user (get)

Essa rota serve para resgatar os dados do usu√°rio. Necessita de autentica√ß√£o.

#### No Body Parameters


| Parameters | Type | Description |
| -------- | -------- | -------- |
| id     | number   |  id √∫nico do usu√°rio |
|  name  |  string  |   nome do usu√°rio  |
| email    | string   | email do usu√°rio|

#### Request

```
Os dados do usu√°rio logado s√£o resgatados atrav√©s das informa√ß√µes extra√≠das do Headers pelo (token)
```

#### Response (200)
```
{
    "id": 1,
    "name": "Fulano de Tal",
    "email": "fulanodetal@email.com"
}
```

---
### /sendmail (post)

Nessa rota, o usu√°rio poder√° enviar um email, que seria consumido por um forms no frontend. N√£o precisa de autentica√ß√£o.

#### Body Parameters


| Parameters | Type | Description |
| -------- | -------- | -------- |
| sender_name  | string   |  nome do remetente |
|  email  |  string  |   email do remetente  |
| phone    | string   | telefone do remetente|
| company    | string   | nome da empresa do remetente|
| sender_message    | string   | conte√∫do da mensagem|
| contact_reference    | string   | assunto da mensagem|
| message_read    | boolean   | toda mensagem enviada tem seu valor *default* como *false*, significa que essa mensagem ainda n√£o foi lida pelo destinat√°rio |

#### Request

```
{
    "sender_name": "Fulano de Tal",
    "email": "fulano@email.com", 
    "phone": "98912345678",
    "company": "Empresa",
    "sender_message": "Ol√°, eu sou o Fulano de Tal. Gostaria de conversar     sobre empreendimentos.",
    "contact_reference": "N√©g√≥cios",
    "message_read": false
}
```

#### Response (201)
```
{
    "message": "Mensagem enviada com sucesso"
}
```

### Exemplo de mensagem autom√°tica recebida pelo remetente ap√≥s enviar uma mensagem. Email do tipo *hotmail*
![](https://i.imgur.com/dNXtEsS.png)



### Poss√≠veis erros de envio de mensagem no formul√°rio
#### Error (422) - Quando existe algum campo em branco na requisi√ß√£o

```
{
    "message": "Voc√™ precisa preencher todos os campos obrigat√≥rios"
}
```

#### Error (422) - Houve um erro ao tentar enviar a mensagem

```
{
    "message": "Mensagem n√£o enviada"
}
```

---
### /viewmessages (get)

Com essa rota o usu√°rio poder√° listar todas as mensagens recebidas. Necessita de autentica√ß√£o.

#### No Body Parameters


| Parameters | Type | Description |
| -------- | -------- | -------- |
| id  | number   |  id √∫nico da mensagem recebida |
|  sender_name  |  string  |   nome do remetente  |
| company    | string   | nome da empresa do remetente|
| email    | string   | email do remetente|
| phone    | string   | telefone do remetente|
| contact_reference    | string   | assunto da mensagem|
| message_read    | boolean   | *false* se o destinat√°rio ainda n√£o tiver lido a mensagem ou *true* caso ele ja tenha lido a mensagem |

#### Request

```
Sem dados enviado no body da requisi√ß√£o
```

#### Response (201)

```
{
    "sender_name": "Fulano de Tal",
    "email": "fulano@email.com", 
    "phone": "98912345678",
    "company": "Empresa",
    "sender_message": "Ol√°, eu sou o Fulano de Tal. Gostaria de conversar     sobre empreendimentos.",
    "contact_reference": "N√©g√≥cios",
    "message_read": true
}
```

#### N√£o √© exatamente um *erro*

#### Error (404) - Quando n√£o h√° mensagens recebidas a serem resgatadas na requisi√ß√£o

```
{
    "message": "Voc√™ n√£o possui nenhuma mensagem a ser exibida"
}
```


---
### /messageread/:id (patch)

Essa rota serve para mudar o valor do campo *message_read* da tabela *messages*. A mudan√ßa s√≥ ocorre uma √∫nica vez. Quando o usu√°rio abre a mensagem recebida, ela muda seu valor de *false* para *true*.

#### Request

```
O id da mensagem √© enviado pelo par√¢metro da rota.

Exemplo: https://contact-forms-qgj8.onrender.com/messageread/1
```
#### Response (200)

```
{
    "message": "Dados atualizados com sucesso"
}
```

### Poss√≠veis erros ao tentar mudar o *status* da mensagem para *lida (true)* 
#### Error (400) - Erro ao carregar os dados solicitados

```
{
    "message": "Houve um erro ao ler os dados da mensagem"
}
```



#### Error (422) - Quando a mensagem j√° foi lida, ela n√£o pode voltar ao *status* de *n√£o lida (false*)

```
{
    "message": "Essa mensagem ja foi lida"
}
```

#### Error (400) - Houve um erro ao tentar alterar o *status* da mensagem de *n√£o lida (false)* para *lida (true)*

```
{
    "message": "N√£o foi poss√≠vel atualizar os dados da mensagem"
}
```

---
### /replay (post)

Nessa rota √© poss√≠vel responder √† uma mensagem recebida. Necessita de autentica√ß√£o.

#### Body Parameters


| Parameters | Type | Description |
| -------- | -------- | -------- |
| id_message  | number   |  id √∫nico da mensagem recebida |
|  receiver_email  |  string  |   email do remetente da mensagem √† ser respondida  |
| message    | string   | conte√∫do da mensagem|

#### Request

```
{
    "id_message": 1,
    "receiver_email": "fulanodetal@email.com",
    "message": "Oi. Entro em contato assim que poss√≠vel, estou viajando no momento."
}
```
#### Response (200)

```
{
    "message": "Mensagem enviada com sucesso"
}
```

### Exemplo de mensagem respondida √† email do tipo *hotmail*

![](https://i.imgur.com/ZX9zhYm.png)



### Poss√≠veis erros ao tentar responder uma mensagem recebia 
#### Error (400) - Erro ao tentar enviar a mensagem em branco

```
{
    "message": "Voc√™ esta tentando enviar uma resposta em branco ou n√£o informou o destinat√°rio correto"
}
```

#### Error (400) - Erro ao tentar enviar a mensagem

```
{
    "message": "Mensagem n√£o enviada"
}
```

---

    
---
## üöÄ Como executar o projeto

```bash

# Clone este reposit√≥rio
$ git clone https://github.com/Dionn-AP/Project-Form-Thaynara-OG--Maximize-backend.git

# Acesse a pasta do projeto no seu terminal/cmd
$ cd Project-Form-Thaynara-OG--Maximize-backend

# Instale as depend√™ncias
$ npm install

ou

$ yarn install

# Execute a aplica√ß√£o
$ npm run dev

ou

$ yarn start

```
---
## üõ† Tecnologias

As seguintes ferramentas foram usadas na constru√ß√£o do projeto:

#### **Website**  
- **[Node](https://nodejs.org/en/)**
- **[Express](https://expressjs.com/pt-br/)**
- **[Knex](https://knexjs.org/)**
- **[PostgresSQL](https://www.postgresql.org/)**
- **[Dotenv](https://www.npmjs.com/package/dotenv)**
- **[Bcrypt](https://www.npmjs.com/package/bcrypt)**
- **[Jsonwebtoken](https://www.npmjs.com/package/jsonwebtoken)**
- **[Javascript](https://www.javascript.com/)**
- **[Cors](https://www.npmjs.com/package/cors)**
- **[Nodemailer](https://nodemailer.com/about/)**
- **[Nodemon](https://www.npmjs.com/package/nodemon)**    

> Veja o arquivo  [package.json](https://github.com/Dionn-AP/Project-Form-Thaynara-OG--Maximize-backend/blob/main/package.json)

#### **Utilit√°rios**

- Prot√≥tipo:  **[Figma](https://www.figma.com/)**
- Banco de Dados:  **[Supabase](https://supabase.com/)**
- Deploy da Aplica√ß√£o: **[Render](https://dashboard.render.com/)**
- Editor:  **[Visual Studio Code](https://code.visualstudio.com/)**
- Markdown:  **[HackMD](https://hackmd.io/)**
- Teste de API:  **[Postman](https://www.postman.com/)**
---
## üë®‚Äçüíª Desenvolvedor

üëè Esse que vos fala!

<table>
  <tr>
    <td align="center" style="padding: "><a href="https://portifolio-dionnatan.netlify.app/"><img style="border-radius: 50%;" src="https://github.com/Dionn-AP.png" width="100px;" alt=""/><br /><sub><b>Dionnatan Alves</b></sub></a><br />
        <h4>Portif√≥lio</h4>        
      </td>
    
  </tr>
</table>
